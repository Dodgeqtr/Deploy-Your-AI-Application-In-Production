import os
from dotenv import load_dotenv
from azure.identity import DefaultAzureCredential
from azure.ai.projects import AIProjectClient
from azure.ai.projects.models import PromptAgentDefinition

# 1. ØªØ­Ù…ÙŠÙ„ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠØ©
load_dotenv()
ENDPOINT = os.environ.get("PROJECT_ENDPOINT")
MODEL_NAME = "gpt-4.1-mini" # Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ ÙÙŠ Ø¯Ù„ÙŠÙ„Ùƒ
AGENT_NAME = "Sovereign-AI-Jojo"

# 2. Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù…Ø¹ Ù…Ø³Ø¨Ùƒ Ù…Ø§ÙŠÙƒØ±ÙˆØ³ÙˆÙØª (Azure AI Foundry)
project_client = AIProjectClient(
    endpoint=ENDPOINT,
    credential=DefaultAzureCredential(),
)

# 3. Ø¥Ù†Ø´Ø§Ø¡/ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙƒÙŠÙ„ Ø¨ØªØ¹Ù„ÙŠÙ…Ø§Øª "Ø§Ù„ÙˆÙƒØ±Ø© 2026"
agent = project_client.agents.create_version(
    agent_name=AGENT_NAME,
    definition=PromptAgentDefinition(
        model=MODEL_NAME,
        instructions="""
        Ø£Ù†Øª Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ù…ØªÙ„ÙƒØ§Øª Ø§Ù„ÙˆÙƒØ±Ø© 2026. 
        Ù‚ÙˆØ§Ù†ÙŠÙ†Ùƒ Ø§Ù„ØµØ§Ø±Ù…Ø©: 
        1. Ø£ÙŠ ÙØ§ØªÙˆØ±Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¡ ØªØªØ¬Ø§ÙˆØ² 5 Ø±ÙŠØ§Ù„ Ù‚Ø·Ø±ÙŠ ØªØ¹ØªØ¨Ø± Ø®Ø±Ù‚Ø§Ù‹ Ø£Ù…Ù†ÙŠØ§Ù‹.
        2. Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù‡Ùˆ Ù…Ø´Ø±ÙˆØ¹ jojo-451011 ÙÙŠ Google Cloud.
        3. Ù„ØºØªÙƒ Ø§Ù„Ø±Ø³Ù…ÙŠØ© Ù‡ÙŠ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ØŒ ÙˆØ´Ø®ØµÙŠØªÙƒ Ø¬Ø±ÙŠØ¦Ø© ÙˆÙ…Ù‚Ø¯Ø§Ù…Ø©.
        """
    ),
)

print(f"âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆÙƒÙŠÙ„ ÙÙŠ Ø§Ù„Ù…Ø³Ø¨Ùƒ: {agent.name} (ID: {agent.id})")

# 4. Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ÙˆØ§Ù„Ø±Ù‚Ø§Ø¨Ø©
openai_client = project_client.get_openai_client()
conversation = openai_client.conversations.create()

# Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆÙƒÙŠÙ„ Ø¹Ù„Ù‰ Ø£ÙˆÙ„ Ù…Ù„Ù PDF Ù…Ù† "Ù‚Ø¶ÙŠØªÙŠ"
response = openai_client.responses.create(
    conversation=conversation.id,
    extra_body={"agent": {"name": AGENT_NAME, "type": "agent_reference"}},
    input="Ø§ÙØ­Øµ Ù…Ù„ÙØ§Øª PDF Ø§Ù„Ù…Ø­Ù…Ù„Ø©ØŒ Ù‡Ù„ Ù‡Ù†Ø§Ùƒ ÙØ§ØªÙˆØ±Ø© ØªØªØ¬Ø§ÙˆØ² 5 Ø±ÙŠØ§Ù„ØŸ",
)

print(f"ğŸ“£ Ø±Ø¯ Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ: {response.output_text}")